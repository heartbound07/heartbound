/* ============================================================================
   INVENTORY PAGE CSS - OPTIMIZED VERSION
   ============================================================================
   
   OPTIMIZATIONS MADE:
   1. Consolidated redundant selectors and properties
   2. Optimized animations for mobile performance
   3. Improved CSS organization and structure
   4. Added hardware acceleration for smoother animations
   5. Reduced layout shifts that cause flickering
   6. Better use of CSS custom properties
   
   MOBILE FLICKERING FIXES:
   - Reduced transform complexity
   - Optimized backdrop-filter usage
   - Prevented layout shifts with consistent sizing
   - Added will-change properties for better performance
   ============================================================================ */

/* ============================================================================
   CSS CUSTOM PROPERTIES (VARIABLES)
   ============================================================================ */
:root {
  /* Base colors and effects */
  --inventory-card-bg: rgba(30, 41, 59, 0.3);
  --inventory-card-border: rgba(148, 163, 184, 0.1);
  --inventory-card-hover-bg: rgba(30, 41, 59, 0.5);
  --inventory-backdrop-blur: blur(10px);
  
  /* Animation properties */
  --inventory-transition-fast: all 0.2s ease;
  --inventory-transition-standard: all 0.3s ease;
  --inventory-hover-transform: translateY(-5px);
  --inventory-scale-active: scale(0.95);
  
  /* Spacing and sizing */
  --inventory-grid-gap: 1.5rem;
  --inventory-card-radius: 0.75rem;
  --inventory-section-padding: 1.5rem;
  --inventory-button-padding: 0.75rem 1.5rem;
  
  /* Typography */
  --inventory-font-family: 'gg sans', sans-serif;
  --inventory-title-font: 'Grandstander', sans-serif;
  
  /* Layout dimensions */
  --inventory-max-width: 1600px;
  --inventory-preview-width: 400px;
  --inventory-preview-width-large: 450px;
  --inventory-grid-min-width: 280px;
  --inventory-item-height: 160px;
  
  /* Refined grid sizing for consistent columns */
  --inventory-grid-min-width-desktop: 300px;  /* Increased from 280px */
  --inventory-grid-min-width-tablet: 280px;   /* Tablet size */
  --inventory-grid-min-width-mobile: 260px;   /* Mobile size */
  
  /* Consistent gaps */
  --inventory-grid-gap-desktop: 1.5rem;
  --inventory-grid-gap-tablet: 1.25rem;       /* Intermediate gap */
  --inventory-grid-gap-mobile: 1rem;
}

/* ============================================================================
   BASE LAYOUT STRUCTURE
   ============================================================================ */

/* Main container */
.inventory-page-container {
  max-width: var(--inventory-max-width);
  margin: 0 auto;
  font-family: var(--inventory-font-family);
}

/* Page title styling */
.inventory-title {
  font-family: var(--inventory-title-font);
  text-align: center;
  font-size: 2.25rem;
  letter-spacing: 0.5px;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  margin-bottom: 1rem;
  color: white;
  font-weight: bold;
}

.inventory-subtitle {
  text-align: center;
  color: #94a3b8;
  margin-bottom: 2.5rem;
  font-size: 1.1rem;
}

/* ============================================================================
   MAIN LAYOUT CONTAINER
   ============================================================================ */

/* Two-column layout container with optimized performance */
.inventory-layout-container {
  display: flex;
  gap: 2rem;
  width: 100%;
  /* Prevent layout shifts */
  contain: layout;
}

/* Desktop layout optimizations */
@media (min-width: 1201px) {
  .inventory-layout-container {
    /* REMOVED: flex-direction: row-reverse; */
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 2rem;
  }
  
  .item-preview-container {
    /* REMOVED: Fixed height that caused content clipping */
    /* height: 400px; */
    /* max-height: 400px; */

    /* ADDED: Allow container to grow, but not exceed 90% of the viewport height */
    max-height: 90vh;
  }
}

/* ============================================================================
   COLUMN LAYOUT DEFINITIONS
   ============================================================================ */

/* NEW: Main content area that holds filters, controls, and the grid/preview container */
.inventory-main-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-width: 0; /* Prevents flexbox overflow issues */
}

/* NEW: Flex container for the grid and the preview panel */
.inventory-grid-and-preview-container {
  display: flex;
  gap: 2rem;
  flex: 1;
  min-height: 0; /* Allows container to shrink vertically if needed */
}

/* NEW: Container for the grid and its controls to keep them together */
.inventory-grid-with-controls {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-width: 0;
}

/* NEW: Wrapper for the item preview to control its size */
.item-preview-wrapper {
  flex: 0 0 var(--inventory-preview-width);
  min-width: var(--inventory-preview-width);
  max-width: var(--inventory-preview-width-large);
  position: relative; /* Needed for sticky child */
}


/* ============================================================================
   CATEGORY FILTERS - OPTIMIZED
   ============================================================================ */

.inventory-categories {
  margin-bottom: 1.5rem;
}

.inventory-categories-scroll-container {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  overflow-x: auto;
  padding-bottom: 0.5rem;
  scroll-behavior: smooth;
  /* Hide scrollbars */
  -ms-overflow-style: none;
  scrollbar-width: none;
  /* Performance optimization */
  -webkit-overflow-scrolling: touch;
}

.inventory-categories-scroll-container::-webkit-scrollbar {
  display: none;
}

/* Unified category button styles */
.category-button {
  padding: 0.5rem 1rem;
  border-radius: 0.5rem;
  font-weight: 500;
  transition: var(--inventory-transition-fast);
  cursor: pointer;
  border: none;
  font-size: 0.875rem;
  white-space: nowrap;
  font-family: var(--inventory-font-family);
  /* Prevent layout shifts */
  flex-shrink: 0;
  /* Hardware acceleration */
  transform: translateZ(0);
  will-change: background-color, border-color, transform;
}

.category-button-active {
  background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
  color: white;
  box-shadow: 0 2px 4px rgba(var(--color-primary-rgb), 0.3);
}

.category-button-inactive {
  background: var(--inventory-card-bg);
  color: rgba(148, 163, 184, 0.9);
  border: 1px solid var(--inventory-card-border);
}

.category-button-inactive:hover {
  background: var(--inventory-card-hover-bg);
  color: white;
  border-color: rgba(148, 163, 184, 0.4);
  transform: translateY(-1px);
}

/* ============================================================================
   CONTROLS AND SORTING
   ============================================================================ */

.inventory-controls {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  flex-wrap: wrap;
  gap: 1rem;
}

.sort-control-container {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.inventory-sort-dropdown {
  padding: 0.5rem 0.75rem;
  background: rgba(30, 41, 59, 0.5);
  border: 1px solid var(--inventory-card-border);
  border-radius: 0.5rem;
  color: white;
  font-size: 0.875rem;
  cursor: pointer;
  transition: var(--inventory-transition-fast);
  font-family: var(--inventory-font-family);
}

.inventory-sort-dropdown:hover,
.inventory-sort-dropdown:focus {
  background: rgba(30, 41, 59, 0.7);
  border-color: rgba(148, 163, 184, 0.4);
  outline: none;
}

.inventory-sort-dropdown:focus {
  border-color: var(--color-primary);
  box-shadow: 0 0 0 2px rgba(var(--color-primary-rgb), 0.2);
}

/* ============================================================================
   INVENTORY GRID - FIXED COLUMN CONSISTENCY
   ============================================================================ */

/* Base inventory grid with more predictable sizing */
.inventory-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(var(--inventory-grid-min-width-desktop), 1fr));
  gap: var(--inventory-grid-gap-desktop);
  overflow-y: auto;
  padding-right: 0.5rem;
  scroll-behavior: smooth;
  padding-bottom: 1rem;
  align-content: start;
  contain: layout;
  will-change: scroll-position;
  
  /* Add consistent minimum width to prevent column jumping */
  min-width: 0; /* Ensure flex shrinking works properly */
}

/* Optimized scrollbar styles */
.inventory-grid::-webkit-scrollbar {
  width: 8px;
}

.inventory-grid::-webkit-scrollbar-track {
  background: var(--inventory-card-bg);
  border-radius: 4px;
}

.inventory-grid::-webkit-scrollbar-thumb {
  background: rgba(148, 163, 184, 0.4);
  border-radius: 4px;
  transition: var(--inventory-transition-fast);
}

.inventory-grid::-webkit-scrollbar-thumb:hover {
  background: rgba(148, 163, 184, 0.6);
}

/* Firefox scrollbar */
.inventory-grid {
  scrollbar-width: thin;
  scrollbar-color: rgba(148, 163, 184, 0.4) var(--inventory-card-bg);
}

/* ============================================================================
   INVENTORY ITEM CARDS - OPTIMIZED ANIMATIONS
   ============================================================================ */

.inventory-item-card {
  position: relative;
  border-radius: var(--inventory-card-radius);
  background: var(--inventory-card-bg);
  overflow: visible;
  transition: var(--inventory-transition-standard);
  backdrop-filter: var(--inventory-backdrop-blur);
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  cursor: pointer;
  /* Performance optimizations */
  transform: translateZ(0);
  will-change: transform, box-shadow;
}

.inventory-item-card:hover {
  transform: var(--inventory-hover-transform) translateZ(0);
  box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.2);
}

.inventory-item-card.inventory-item-selected {
  box-shadow: 0 0 0 2px var(--color-primary);
  transform: translateY(-3px) translateZ(0);
}

/* Item image container */
.inventory-item-image {
  height: var(--inventory-item-height);
  background: rgba(30, 41, 59, 0.5);
  position: relative;
  overflow: hidden;
}

.inventory-item-content {
  padding: 1rem;
}

/* ============================================================================
   ITEM BADGES AND INDICATORS
   ============================================================================ */

.equipped-badge,
.badge-equipped {
  position: absolute;
  top: 0.75rem;
  right: 0.75rem;
  font-size: 0.75rem;
  font-weight: 600;
  padding: 0.25rem 0.75rem;
  border-radius: 9999px;
  background-color: var(--color-primary);
  color: white;
  z-index: 10;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  /* Prevent layout shifts */
  transform: translateZ(0);
}

/* ============================================================================
   ACTION BUTTONS - UNIFIED STYLES
   ============================================================================ */

.item-action-button,
.item-preview-action-btn {
  padding: var(--inventory-button-padding);
  border-radius: 0.5rem;
  font-weight: 600;
  border: none;
  cursor: pointer;
  transition: var(--inventory-transition-fast);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.95rem;
  font-family: var(--inventory-font-family);
  /* Performance optimization */
  transform: translateZ(0);
  will-change: transform, box-shadow;
}

/* Equip button styles */
.equip-button,
.equip-action-btn {
  background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
  color: white;
  box-shadow: 0 4px 6px -1px rgba(var(--color-primary-rgb), 0.2);
}

.equip-button:hover:not(:disabled),
.equip-action-btn:hover {
  background: linear-gradient(135deg, var(--color-primary-dark) 0%, var(--color-primary-dark) 100%);
  box-shadow: 0 6px 8px -1px rgba(var(--color-primary-rgb), 0.25);
  transform: translateY(-1px) translateZ(0);
}

/* Unequip button styles */
.unequip-button,
.unequip-action-btn {
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.8) 0%, rgba(239, 68, 68, 1) 100%);
  color: white;
  box-shadow: 0 4px 6px -1px rgba(239, 68, 68, 0.2);
}

.unequip-button:hover:not(:disabled),
.unequip-action-btn:hover {
  background: linear-gradient(135deg, rgba(239, 68, 68, 1) 0%, rgba(239, 68, 68, 1) 100%);
  box-shadow: 0 6px 8px -1px rgba(239, 68, 68, 0.25);
  transform: translateY(-1px) translateZ(0);
}

/* Case action buttons */
.case-action-btn {
  background: linear-gradient(135deg, rgba(168, 85, 247, 0.8) 0%, rgba(168, 85, 247, 1) 100%);
  color: white;
  box-shadow: 0 4px 6px -1px rgba(168, 85, 247, 0.2);
}

.case-action-btn:hover {
  background: linear-gradient(135deg, rgba(168, 85, 247, 1) 0%, rgba(168, 85, 247, 1) 100%);
  box-shadow: 0 6px 8px -1px rgba(168, 85, 247, 0.25);
  transform: translateY(-1px) translateZ(0);
}

/* Batch equip buttons */
.batch-equip-action-btn {
  background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
  color: white;
  border: 1px solid rgba(var(--color-primary-rgb), 0.3);
}

.batch-equip-action-btn:hover {
  background: linear-gradient(135deg, var(--color-primary-dark) 0%, var(--color-primary-dark) 100%);
  box-shadow: 0 4px 8px rgba(var(--color-primary-rgb), 0.4);
  transform: translateY(-1px) translateZ(0);
}

/* Disabled button states */
.mixed-equipped-action-btn,
.action-btn-disabled {
  background: rgba(107, 114, 128, 0.3);
  color: rgba(148, 163, 184, 0.5);
  border: 1px solid rgba(107, 114, 128, 0.3);
  cursor: not-allowed;
  opacity: 0.6;
}

.mixed-equipped-action-btn:hover,
.action-btn-disabled:hover {
  transform: none !important;
  box-shadow: none !important;
}

/* ============================================================================
   EMPTY INVENTORY STATE
   ============================================================================ */

.empty-inventory {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 3rem 2rem;
  background: rgba(30, 41, 59, 0.2);
  border: 1px solid var(--inventory-card-border);
  border-radius: 1rem;
  height: 100%;
  min-height: 300px;
}

.empty-inventory-icon {
  margin-bottom: 1.5rem;
  opacity: 0.7;
}

.empty-inventory-title {
  font-size: 1.5rem;
  font-weight: 600;
  color: white;
  margin-bottom: 0.5rem;
  font-family: var(--inventory-title-font);
}

.empty-inventory-message {
  color: rgba(148, 163, 184, 0.8);
  margin-bottom: 2rem;
  max-width: 400px;
  line-height: 1.6;
}

.visit-shop-button {
  background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
  color: white;
  padding: var(--inventory-button-padding);
  border-radius: 0.5rem;
  font-weight: 600;
  border: none;
  cursor: pointer;
  transition: var(--inventory-transition-fast);
  box-shadow: 0 4px 6px -1px rgba(var(--color-primary-rgb), 0.2);
  font-family: var(--inventory-font-family);
  transform: translateZ(0);
}

.visit-shop-button:hover {
  background: linear-gradient(135deg, var(--color-primary-dark) 0%, var(--color-primary-dark) 100%);
  box-shadow: 0 6px 8px -1px rgba(var(--color-primary-rgb), 0.25);
  transform: translateY(-1px) translateZ(0);
}

/* ============================================================================
   ITEM PREVIEW CONTAINER - OPTIMIZED
   ============================================================================ */

.item-preview-container {
  background: transparent;
  border: 1px solid var(--inventory-card-border);
  border-radius: 1rem;
  padding: 0;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  position: sticky;
  top: 0;
  /* Performance optimization */
  contain: layout;
}

.item-preview-empty {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
}

.item-preview-empty-content {
  text-align: center;
  padding: 2rem;
}

.item-preview-empty-icon {
  display: flex;
  justify-content: center;
  margin-bottom: 1.5rem;
  opacity: 0.6;
  color: rgba(148, 163, 184, 0.6);
}

.item-preview-empty-title {
  font-size: 1.25rem;
  font-weight: 600;
  color: white;
  margin-bottom: 0.5rem;
  font-family: var(--inventory-title-font);
}

.item-preview-empty-subtitle {
  color: rgba(148, 163, 184, 0.7);
  line-height: 1.5;
}

/* Item preview sections */
.item-preview-header {
  padding: var(--inventory-section-padding);
  background: rgba(30, 41, 59, 0.2);
  border-bottom: 1px solid var(--inventory-card-border);
  margin-bottom: 1.5rem;
  text-align: center;
}

.item-preview-header .flex {
  justify-content: center !important;
}

.item-preview-title {
  font-size: 1.5rem;
  font-weight: 700;
  color: white;
  font-family: var(--inventory-title-font);
  margin: 0;
  line-height: 1.2;
  text-align: center;
}

.item-preview-equipped-badge {
  display: flex;
  align-items: center;
  background: rgba(var(--color-primary-rgb), 0.2);
  color: var(--color-primary);
  padding: 0.25rem 0.75rem;
  border-radius: 9999px;
  font-size: 0.75rem;
  font-weight: 600;
  border: 1px solid rgba(var(--color-primary-rgb), 0.3);
}

.item-preview-main {
  padding: 0 var(--inventory-section-padding);
  margin-bottom: 1.5rem;
  flex: 1;
  min-height: 0; /* Allows this container to shrink */
  overflow: hidden; /* Clips content if it still overflows */
  display: flex; /* Make this a flex container */
  flex-direction: column; /* Stack its children vertically */
}

.item-preview-visual {
  position: relative;
  background: transparent;
  border-radius: var(--inventory-card-radius);
  border: 2px solid;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  flex: 1; /* Allow this to grow and shrink within the main area */
}

.item-preview-glow {
  position: absolute;
  inset: -4px;
  border-radius: var(--inventory-card-radius);
  opacity: 0.3;
  pointer-events: none;
}

.item-preview-details {
  padding: var(--inventory-section-padding);
  background: rgba(30, 41, 59, 0.2);
  border-top: 1px solid var(--inventory-card-border);
  overflow-y: auto;
  display: flex;
  flex-direction: column;
}

.item-preview-selected-items {
  margin-bottom: 1.5rem;
}

.item-preview-selected-items h4 {
  margin-bottom: 0.75rem;
}

.selected-item-row {
  padding: 0.75rem 0;
  border-bottom: 1px solid var(--inventory-card-border);
  word-break: break-word;
  overflow-wrap: anywhere;
}

.selected-item-row:last-child {
  border-bottom: none;
}

.item-preview-actions {
  display: flex;
  justify-content: center;
}

.item-preview-description {
  margin-bottom: 1.5rem;
  padding-top: 1rem;
}

/* ============================================================================
   CASE-SPECIFIC STYLES
   ============================================================================ */

.case-preview-container .rarity-glow {
  animation-duration: 4s;
}

.case-icon {
  animation: case-pulse 3s ease-in-out infinite;
}

@keyframes case-pulse {
  0%, 100% {
    transform: scale(1);
    opacity: 1;
  }
  50% {
    transform: scale(1.05);
    opacity: 0.9;
  }
}

.case-preview-visual {
  position: relative;
  margin-bottom: 1rem;
  display: flex;
  justify-content: center;
}

.case-preview-image,
.case-preview-icon {
  width: 80px;
  height: 80px;
  border-radius: var(--inventory-card-radius);
  border: 3px solid;
}

.case-preview-image {
  object-fit: cover;
}

.case-preview-icon {
  display: flex;
  align-items: center;
  justify-content: center;
}

.case-preview-mystical {
  position: absolute;
  inset: 0;
  border-radius: var(--inventory-card-radius);
  opacity: 0.3;
  pointer-events: none;
}

.case-preview-stats {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  margin-bottom: 1rem;
}

.case-stat {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: rgba(30, 41, 59, 0.5);
  padding: 0.5rem 0.75rem;
  border-radius: 0.5rem;
  border: 1px solid var(--inventory-card-border);
}

.case-stat-label {
  color: rgba(148, 163, 184, 0.8);
  font-size: 0.875rem;
}

.case-stat-value {
  color: white;
  font-weight: 600;
  font-size: 0.875rem;
}

.case-view-contents-btn {
  width: 100%;
  padding: 0.75rem;
  background: rgba(var(--color-primary-rgb), 0.1);
  color: var(--color-primary);
  border: 1px solid rgba(var(--color-primary-rgb), 0.3);
  border-radius: 0.5rem;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: var(--inventory-transition-fast);
  display: flex;
  align-items: center;
  justify-content: center;
}

.case-view-contents-btn:hover {
  background: rgba(var(--color-primary-rgb), 0.2);
  border-color: rgba(var(--color-primary-rgb), 0.5);
}

/* ============================================================================
   BADGE GALLERY STYLES - OPTIMIZED
   ============================================================================ */

.badge-gallery {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  padding: 1.5rem 0;
}

.badge-gallery-title {
  font-family: var(--inventory-title-font);
  font-size: 1.75rem;
  font-weight: bold;
  color: white;
  margin-bottom: 0.5rem;
  text-align: center;
}

.badge-gallery-subtitle {
  text-align: center;
  color: #94a3b8;
  margin-bottom: 2rem;
  font-size: 1rem;
}

.badge-gallery-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 1.5rem;
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
}

/* Badge item styles */
.badge-item {
  cursor: pointer;
  position: relative;
  z-index: 1;
  /* Performance optimization */
  transform: translateZ(0);
}

.badge-item:active .badge-icon-container {
  transform: scale(0.95) translateZ(0);
}

.badge-item-wrapper {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  isolation: isolate;
}

.badge-icon-container {
  position: relative;
  width: 80px;
  height: 80px;
  border-radius: 50%;
  border: 2px solid;
  margin-bottom: 0.75rem;
  background-color: rgba(15, 23, 42, 0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: var(--inventory-transition-standard);
  /* Performance optimization */
  transform: translateZ(0);
  will-change: transform;
}

.badge-icon-inner {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
}

.badge-icon {
  width: 90%;
  height: 90%;
  object-fit: cover;
  border-radius: 50%;
}

.badge-equipped-indicator {
  position: absolute;
  top: -2px;
  right: -2px;
  background-color: var(--color-primary);
  color: white;
  width: 22px;
  height: 22px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 2px solid #0f172a;
  z-index: 10;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.25);
}

.badge-name {
  font-size: 0.875rem;
  font-weight: 500;
  color: white;
  margin-bottom: 0.25rem;
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.badge-rarity-label {
  font-size: 0.7rem;
  padding: 0.125rem 0.5rem;
  border-radius: 999px;
  display: inline-block;
}

.badge-rarity-glow {
  position: absolute;
  inset: 0;
  border-radius: 50%;
  z-index: -1;
  opacity: 0;
  pointer-events: none;
}

.badge-equipped-glow {
  opacity: 0.3;
}

.badge-description {
  color: #e2e8f0;
  font-size: 0.8rem;
  max-height: 80px;
  overflow-y: auto;
  text-align: center;
  margin-bottom: 0;
}

.badge-action-container {
  display: flex;
  justify-content: center;
  width: 100%;
  margin: 0;
  padding: 0;
}

.badge-action-button {
  width: 100%;
  font-size: 0.75rem;
  font-weight: 500;
  padding: 0.375rem 0;
  border-radius: 0.25rem;
  transition: var(--inventory-transition-fast);
  text-align: center;
  display: flex;
  justify-content: center;
  align-items: center;
  margin: 0;
  /* Performance optimization */
  transform: translateZ(0);
  will-change: transform;
}

.badge-equip-button {
  background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
  color: white;
}

.badge-equip-button:hover:not(:disabled) {
  background: linear-gradient(135deg, var(--color-primary-dark) 0%, var(--color-primary-dark) 100%);
  transform: translateY(-1px) translateZ(0);
}

.badge-unequip-button {
  background-color: rgba(30, 41, 59, 0.8);
  color: white;
  border: 1px solid rgba(148, 163, 184, 0.2);
}

.badge-unequip-button:hover:not(:disabled) {
  background-color: rgba(30, 41, 59, 1);
  transform: translateY(-1px) translateZ(0);
}

.badge-action-processing {
  opacity: 0.7;
  cursor: not-allowed;
}

.badge-action-persistent {
  margin-top: 0.5rem;
  width: 90%;
}

/* ============================================================================
   ANIMATIONS AND EFFECTS - OPTIMIZED
   ============================================================================ */

/* Shimmer effect for loading states */
@keyframes shimmer {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

.inventory-skeleton {
  background: linear-gradient(
    90deg,
    rgba(255, 255, 255, 0.05) 25%,
    rgba(255, 255, 255, 0.1) 50%,
    rgba(255, 255, 255, 0.05) 75%
  );
  background-size: 200% 100%;
  animation: shimmer 1.5s infinite;
}

/* Rarity glow effects */
.rarity-glow {
  position: absolute;
  inset: -1px;
  border-radius: 0.9rem;
  z-index: -1;
  opacity: 0;
  pointer-events: none;
}

.rarity-glow-equipped {
  opacity: 0.3;
}

.inventory-item-inner {
  border-radius: var(--inventory-card-radius);
  overflow: hidden;
  position: relative;
  z-index: 1;
  height: 100%;
  border-width: 1px;
  border-style: solid;
}

.recently-equipped {
  box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.5);
  transition: box-shadow 0.3s ease-in-out;
}

/* ============================================================================
   RESPONSIVE DESIGN - MOBILE OPTIMIZED
   ============================================================================ */

/* Large desktop adjustments */
@media (max-width: 1400px) {
  .inventory-layout-container {
    gap: 1.5rem;
  }

  .inventory-grid-and-preview-container {
    gap: 1.5rem;
  }
  
  .item-preview-wrapper {
    flex: 0 0 350px;
    min-width: 350px;
    max-width: 380px;
  }
}

/* Tablet and mobile layout */
@media (max-width: 1200px) {
  .inventory-layout-container {
    flex-direction: column;
    height: auto;
    max-height: none;
    /* Prevent layout shifts */
    contain: layout;
  }
  
  .inventory-grid-and-preview-container {
    flex-direction: column;
    order: 2; /* Show preview above the grid on mobile */
  }

  .item-preview-wrapper {
    order: 1; /* Ensure preview comes first visually */
    margin-bottom: 2rem;
  }
  
  .inventory-grid-container {
    order: 2;
    max-height: 600px;
  }
  
  .inventory-grid {
    max-height: 600px;
  }
  
  /* Mobile fixes for item preview */
  .item-preview-container {
    position: static;
    /* margin-bottom is now on the wrapper */
  }
}

/* Mobile phone optimizations */
@media (max-width: 768px) {
  .inventory-page-container {
    padding: 0 1rem;
  }
  
  .inventory-layout-container {
    gap: 1rem;
  }
  
  .inventory-grid {
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 1rem;
  }
  
  .inventory-controls {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.75rem;
  }
  
  .inventory-categories-scroll-container {
    justify-content: flex-start;
  }
  
  .item-preview-container {
    margin-bottom: 1.5rem;
  }

  .item-preview-wrapper {
    margin-bottom: 0; /* Reset margin, it's now on the container */
  }
  
  .item-preview-header {
    padding: 1.25rem 1.25rem 1rem 1.25rem;
  }
  
  .item-preview-main {
    padding: 0 1.25rem;
    margin-bottom: 1rem;
  }
  
  .item-preview-details {
    padding: 1rem 1.25rem 1.25rem 1.25rem;
    flex-grow: 1;
  }
  
  /* Badge gallery responsive */
  .badge-gallery-grid {
    grid-template-columns: repeat(3, 1fr);
  }
  
  .badge-icon-container {
    width: 70px;
    height: 70px;
  }
  
  .badge-gallery-title {
    font-size: 1.5rem;
  }
}

/* Small mobile optimizations */
@media (max-width: 640px) {
  .inventory-grid {
    grid-template-columns: 1fr;
  }
  
  .inventory-right-column {
    height: auto;
  }
  
  .item-preview-container {
    margin-bottom: 1rem;
  }
  
  .item-preview-header {
    padding: 1rem 1rem 0.75rem 1rem;
  }
  
  .item-preview-title {
    font-size: 1.25rem;
    margin-bottom: 0.25rem;
  }
  
  .item-preview-main {
    padding: 0 1rem;
    margin-bottom: 0.75rem;
  }
  
  .item-preview-details {
    padding: 0.75rem 1rem 1rem 1rem;
    flex-shrink: 0;
    flex-grow: 1;
  }
  
  .item-preview-visual {
    min-height: 140px;
  }
  
  /* Category filters - horizontal scroll on mobile */
  .inventory-categories-scroll-container {
    flex-wrap: nowrap;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }
  
  .category-button {
    flex: 0 0 auto;
    white-space: nowrap;
  }
  
  /* Badge gallery adjustments */
  .badge-gallery-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .badge-action-persistent {
    width: 100%;
  }
}

/* Very small mobile phones */
@media (max-width: 480px) {
  .badge-icon-container {
    width: 65px;
    height: 65px;
  }
  
  .badge-gallery-title {
    font-size: 1.3rem;
  }
  
  .badge-gallery-subtitle {
    font-size: 0.85rem;
  }
  
  .category-button {
    padding: 0.4rem 0.75rem;
    font-size: 0.8rem;
  }
  
  .sort-control-container {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.5rem;
  }
  
  .inventory-sort-dropdown {
    width: 100%;
    font-size: 0.8rem;
  }
  
  .item-preview-container {
    margin-bottom: 0.75rem;
  }
  
  .item-preview-header {
    padding: 0.875rem 0.75rem 0.625rem 0.75rem;
  }
  
  .item-preview-title {
    font-size: 1.125rem;
    margin-bottom: 0.25rem;
  }
  
  .item-preview-main {
    padding: 0 0.75rem;
    margin-bottom: 0.5rem;
  }
  
  .item-preview-details {
    padding: 0.625rem 0.75rem 0.875rem 0.75rem;
    flex-shrink: 0;
    flex-grow: 1;
  }
  
  .item-preview-visual {
    min-height: 120px;
  }
}

/* Mobile landscape optimizations */
@media (max-width: 767px) and (orientation: landscape) {
  .item-preview-container {
    margin-bottom: 0.5rem;
  }
  
  .item-preview-header {
    padding: 0.625rem 0.75rem 0.5rem 0.75rem;
  }
  
  .item-preview-title {
    font-size: 1.125rem;
    margin-bottom: 0.125rem;
  }
  
  .item-preview-visual {
    min-height: 100px;
  }
  
  .item-preview-main {
    padding: 0 0.75rem;
    margin-bottom: 0.5rem;
  }
  
  .item-preview-details {
    padding: 0.5rem 0.75rem 0.625rem 0.75rem;
    max-height: 180px;
    overflow-y: auto;
    flex-grow: 1;
  }
}

/* Touch device optimizations */
@media (hover: none) {
  .badge-action-button {
    padding: 0.5rem 0;
  }
  
  .badge-action-button:active {
    transform: scale(0.98) translateZ(0);
  }
  
  .badge-item {
    cursor: pointer;
    -webkit-tap-highlight-color: transparent;
  }
  
  /* Reduce hover effects on touch devices */
  .inventory-item-card:hover {
    transform: translateZ(0);
  }
  
  .category-button-inactive:hover {
    transform: none;
  }
}

/* High DPI display optimizations */
@media (min-resolution: 2dppx) {
  .inventory-item-card {
    /* Slightly reduce backdrop blur on high DPI for better performance */
    backdrop-filter: blur(8px);
  }
}

/* Responsive typography */
@media (min-width: 768px) {
  .inventory-title {
    font-size: 2.5rem;
  }
}

@media (min-width: 1024px) {
  .inventory-title {
    font-size: 3rem;
  }
}

/* ============================================================================
   PERFORMANCE OPTIMIZATIONS
   ============================================================================ */

/* Optimize animations for better performance */
.inventory-item-card,
.category-button,
.badge-action-button,
.item-action-button {
  /* Use transform3d for hardware acceleration */
  transform: translateZ(0);
  /* Indicate which properties will change */
  will-change: transform;
}

/* Reduce motion for users who prefer it */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
  
  .inventory-item-card:hover {
    transform: none;
  }
  
  .case-pulse {
    animation: none;
  }
}

/* GPU acceleration for scrolling */
.inventory-grid {
  transform: translateZ(0);
  -webkit-overflow-scrolling: touch;
}

/* ============================================================================
   SCROLLBAR COMPENSATION
   ============================================================================ */

/* Add consistent scrollbar handling */
.inventory-grid {
  /* Account for scrollbar width more accurately */
  scrollbar-gutter: stable;
}

/* For webkit browsers */
.inventory-grid::-webkit-scrollbar {
  width: 8px;
  /* Ensure scrollbar doesn't affect layout */
}

/* Ensure the grid container accounts for scrollbar */
.inventory-grid-container {
  flex: 1;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  contain: layout paint;
  
  /* Add consistent border-box sizing */
  box-sizing: border-box;
}

/* ============================================================================
   LAYOUT STABILITY IMPROVEMENTS
   ============================================================================ */

/* Prevent layout shifts from container size changes */
.inventory-layout-container {
  /* Add more specific container queries */
  container-type: inline-size;
  container-name: inventory-layout;
}

/* Use container queries for more precise control (if supported) */
@container inventory-layout (min-width: 1000px) {
  .inventory-grid {
    grid-template-columns: repeat(3, 1fr);
  }
}

@container inventory-layout (max-width: 999px) and (min-width: 600px) {
  .inventory-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@container inventory-layout (max-width: 599px) {
  .inventory-grid {
    grid-template-columns: 1fr;
  }
}

/* ============================================================================
   END OF OPTIMIZED INVENTORY CSS
   ============================================================================ */
